import{entries as f,keys as _,atou as g}from"vuepress-shared/client";import{database as $}from"@temp/search-pro/database";const d=(s,i)=>{const r=s.toLowerCase(),e=i.toLowerCase(),o=[];let l=0,n=0;const a=(t,h=!1)=>{let c="";n===0?c=t.length>20?`… ${t.slice(-20)}`:t:h?c=t.length+n>100?`${t.slice(0,100-n)}… `:t:c=t.length>20?`${t.slice(0,20)} … ${t.slice(-20)}`:t,c&&o.push(c),n+=c.length,h||(o.push(["strong",i]),n+=i.length,n>=100&&o.push(" …"))};let p=r.indexOf(e,l);if(p===-1)return null;for(;p>=0;){const t=p+e.length;if(a(s.slice(l,p)),l=t,n>100)break;p=r.indexOf(e,l)}return n<100&&a(s.slice(l),!0),o},m=s=>s.reduce((i,{type:r})=>i+(r==="title"?50:r==="heading"?20:r==="custom"?10:1),0),E=(s,i)=>{var r;const e={};for(const[o,l]of f(i)){const n=((r=i[o.replace(/\/[^\\]*$/,"")])==null?void 0:r.title)||"",a=`${n?`${n} > `:""}${l.title}`,p=d(l.title,s);p&&(e[a]=[...e[a]||[],{type:"title",path:o,display:p}]),l.customFields&&f(l.customFields).forEach(([t,h])=>{h.forEach(c=>{const u=d(c,s);u&&(e[a]=[...e[a]||[],{type:"custom",path:o,index:t,display:u}])})});for(const t of l.contents){const h=d(t.header,s);h&&(e[a]=[...e[a]||[],{type:"heading",path:o+(t.slug?`#${t.slug}`:""),display:h}]);for(const c of t.contents){const u=d(c,s);u&&(e[a]=[...e[a]||[],{type:"content",header:t.header,path:o+(t.slug?`#${t.slug}`:""),display:u}])}}}return _(e).sort((o,l)=>m(e[o])-m(e[l])).map(o=>({title:o,contents:e[o]}))};let y=JSON.parse(g($));__VUEPRESS_DEV__&&(import.meta.webpackHot||import.meta.hot)&&(__VUE_HMR_RUNTIME__.updateSearchProDatabase=s=>{y=JSON.parse(g(s))}),self.onmessage=({data:s})=>{self.postMessage(E(s.query,y[s.routeLocale]))};
//# sourceMappingURL=index.js.map
